<?php $__env->startSection('notification'); ?>

<?php if(null !== Session::get('message') && Session::get('message') == Enum::successful): ?>
<div class="alert alert-success alert-dismissible" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <?php echo Session::get('reason'); ?>

</div>
<?php elseif(Session::get('message') == Enum::failed): ?>
<div class="alert alert-danger alert-dismissible" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <?php echo Lang::get('warn.error_undefined'); ?>

</div>

<?php endif; ?>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('view_report'); ?>

<?php $__env->stopSection(); ?>



<?php $__env->startSection('report_grade'); ?>
<div class="box box-success">
<?php echo Form::open(array('url'=>action('ProvimetController@getRaportiNotave'),'method'=>'GET')); ?>

    <div class="box-body">
        <div class="row">
            <div class='col-lg-2'>
                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon"><?php echo Lang::get('general.year'); ?></span>
                        <?php if(isset($year)): ?>
                        <?php echo Form::select('year', Enum::getYear(),$year,array('class'=>'form-control ')); ?>

                        <?php else: ?>
                        <?php echo Form::select('year', Enum::getYear(),null,array('class'=>'form-control ')); ?>

                        <?php endif; ?>
                    </div>
                </div>
            </div>
            <div class='col-lg-3'>
                <div class="form-group">
                    <div class="input-group ">
                        <span class="input-group-addon"><?php echo Lang::get('general.month'); ?></span>    
                        <?php if(isset($month)): ?>
                        <?php echo Form::select('month', Enum::getMonthExams(),$month,array('class'=>'form-control ')); ?>

                        <?php else: ?>
                        <?php echo Form::select('month', Enum::getMonthExams(),null,array('class'=>'form-control ')); ?>

                        <?php endif; ?>
                    </div>
                </div>
            </div>
            <div class='col-lg-4'>
                <div class="form-group">
                    <div class="input-group ">
                        <span class="input-group-addon"><?php echo Lang::get('general.profile'); ?></span>
                        <?php if(isset($drejtimSel)): ?>
                        <?php echo Form::select('drejtimi', $drejtimi,$drejtimSel,array('class'=>'form-control ')); ?>

                        <?php else: ?>
                        <?php echo Form::select('drejtimi', $drejtimi,null,array('class'=>'form-control ')); ?>

                        <?php endif; ?>
                    </div>
                </div>
            </div>
            <div class='col-lg-2'>
                <div class="form-group">
                    <div class="col-sm-9">
                        <button name="submit" type="submit" class="btn btn-primary"> <?php echo Lang::get('general.search'); ?></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

<?php echo Form::close(); ?>

<table class='table table-responsive table-bordered'>
    <thead>
        <tr>
            <th>#</th>
            <th><?php echo Lang::get('general.course'); ?></th>
            <th><?php echo Lang::get('general.lecturer'); ?></th>
            <th><?php echo Lang::get('general.profile'); ?></th>
            <th><?php echo Lang::get('general.deadline_exams'); ?></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <?php if(isset($raportet)): ?>
        <?php foreach($raportet as $value): ?>
        <tr>
            <td><?php echo $value->id; ?></td>
            <td><?php echo $value->lendet->Emri; ?></td>
            <td><?php echo $value->administrata->emri." ".$value->administrata->mbiemri; ?></td>
            <td><?php echo $value->lendet->drejtimi->Emri; ?></td>
            <td><?php echo $value['data_provimit']; ?></td>
            <?php if($value['locked'] == Enum::nolocked): ?>
            <td>
                <div class="btn-group">
                    <a href='<?php echo action('ProvimetController@getRegisterNotat',array($value->id)); ?>' class="btn btn-sm btn-success"><?php echo Lang::get('general.register_grade'); ?></a>
                    <button type="button" class="btn btn-sm btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="caret"></span>
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-toggle="modal" data-target="#deleteCourse26"><span class="fa fa-trash-o fa-lg"> </span> Fshij</a></li>
                    </ul>
                </div>
            </td>
            <?php else: ?>
            <td>
                <button type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#viewReport<?php echo $value['idraportit']; ?>">
                    <?php echo Lang::get('general.view_report'); ?>

                </button>
                <?php if(isset($raportet)): ?>
                <?php foreach($raportet as $value): ?>

                <?php
                $year = substr($value['data_provimit'], 0, 4);
                $month = substr($value['data_provimit'], 5, 2);
                ?>
                <div class="modal fade" id="viewReport<?php echo $value['idraportit']; ?>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="myModalLabel"><?php echo Lang::get('general.report_grade'); ?></h4>
                            </div>
                            <div class="modal-body">
                                <table class='table table-responsive table-bordered'>
                                    <tr>
                                        <td><h4><b><?php echo Lang::get('general.course'); ?></b>: <?php echo $value['lenda']; ?><br>
                                                <b><?php echo Lang::get('general.lecturer'); ?>:</b> <span data-toggle="tooltip" data-placement="left" title="UID:<?php echo $value['profuid']; ?>" > <?php echo $value['prof']; ?></span><br>
                                                <b><?php echo Lang::get('general.date'); ?></b>: <?php echo $value['data_provimit']; ?></h4></td>
                                        <td class="text-right">
                                            <a href="#" class="btn btn-sm btn-danger"><span class="fa fa-file-pdf-o" ></span></a>
                                            <a href="<?php echo action('ProvimetController@getPrintReportNotat',array($year,$month,$drejtimSel)); ?>" class="btn btn-sm btn-default" ><span class="fa fa-print" ></span></a>
                                        </td>
                                    </tr>
                                </table>
                                <table class='table table-bordered'>
                                    <thead>
                                        <tr>
                                            <th><?php echo Lang::get('general.student'); ?></th>
                                            <th><?php echo Lang::get('general.test_semester'); ?></th>
                                            <th><?php echo Lang::get('general.test_semisemester'); ?></th>
                                            <th><?php echo Lang::get('general.seminar'); ?></th>
                                            <th><?php echo Lang::get('general.attendance'); ?></th>
                                            <th><?php echo Lang::get('general.practice_work'); ?></th>
                                            <th><?php echo Lang::get('general.final_test'); ?></th>
                                            <th><?php echo Lang::get('general.grade'); ?></th>
                                            <th><?php echo Lang::get('general.refuse'); ?></th>
                                            <th><?php echo Lang::get('general.apply'); ?></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <?php foreach($reportList[$value['idraportit']] as $oneStudent): ?>
                                        <tr id="listRStdrow<?php echo $value['idraportit'].$oneStudent['studenti']; ?>">
                                            <td><?php echo $oneStudent['emri']." ".$oneStudent['mbiemri']; ?></td>
                                            <td><?php echo $oneStudent['testi_semestral']; ?></td>
                                            <td><?php echo $oneStudent['testi_gjysemsemestral']; ?></td>
                                            <td><?php echo $oneStudent['seminari']; ?></td>
                                            <td><?php echo $oneStudent['pjesmarrja']; ?></td>
                                            <td><?php echo $oneStudent['puna praktike']; ?></td>
                                            <td><?php echo $oneStudent['testi_final']; ?></td>
                                            <td><?php echo $oneStudent['nota']; ?></td>
                                            <td><?php echo Enum::convertRefuzimi($oneStudent['refuzim']); ?></td>
                                            <td><?php echo Enum::convertParaqitjen($oneStudent['paraqit']); ?></td>

                                        </tr>
                                        <?php endforeach; ?>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <?php endforeach; ?>
                <?php endif; ?>
            </td>
            <?php endif; ?>
        </tr>
        <?php endforeach; ?>
        <?php endif; ?>
    </tbody>
</table>

</div>
<?php $__env->stopSection(); ?>
<?php $__env->startSection('title'); ?>
<section class="content-header">
    <h1>
        <?php echo Lang::get('general.report_grade'); ?><small><?php echo Lang::get('general.report_grade'); ?></small>
    </h1>
</section>
<?php $__env->stopSection(); ?>



<?php $__env->startSection('content'); ?>
<?php echo $__env->yieldContent('title'); ?>
<section class="content">

    <?php echo $__env->yieldContent('content'); ?>

    <hr>
    <?php echo $__env->yieldContent('notification'); ?>
    <?php echo $__env->yieldContent('report_grade'); ?>
</section>
<?php $__env->stopSection(); ?>
<?php echo $__env->make("admin.index", array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>